default_platform(:ios)

platform :ios do
  desc "Description of what the lane does"
  lane :release do
    pod_push(path: 'TestTabBar.podspec')
    set_github_release(
      repository_name: "lukile/TestTabBarLibrary",
      api_token: "9bc99af338624c0adab0849738b75bde899ca330",
      name: "Release " + get_version_number,
      tag_name: last_git_tag,
      is_prerelease: true,
      description: "This release's description Test",
      commitish: "master"
    )

    version_bump_podspec(path: "TestTabBarLibrary.podspec", bump_type: "patch")
    increment_version_number(
      bump_type: "patch" # Automatically increment patch version number
    )
    
    add_git_tag(
      tag: get_version_number(xcodeproj: "TestTabBar.xcodeproj")
    )
    pod_push(path: "TestTabBarLibrary.podspec")

  	slack(
  		message: "MESSAGE TESTÂ ",
  		slack_url: "https://hooks.slack.com/services/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"
  	)

  end
  lane :devices do
    #scan(workspace: 'TestTabBar.xcodeproj/project.xcworkspace')
    run_tests(
      scheme: "TestTabBar",
      devices: ["iPhone XR", "iPhone XS"],
      clean: true,
    )
		slack(
			message: "Test devices",
			slack_url: "https://hooks.slack.com/services/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",
			channel: "#devices"
		)
  end
end