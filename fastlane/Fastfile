default_platform(:ios)

platform :ios do
  desc "Description of what the lane does"

  lane :build do
    case git_branch
    when "develop"
      develop
    when "master"
      master
    end
  end

  lane :develop do

    slack(
  		message: "MESSAGE TEST " + get_version_number,
  		slack_url: "https://hooks.slack.com/services/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"
  	)

  end

  lane :master do
    set_github_release(
      repository_name: "lukile/TestTabBarLibrary",
      api_token: "2c2f9557490c5ee1927ba550b819a2bfb2b8e3ce",
      name: "Release " + get_version_number,
      tag_name: last_git_tag,
      is_prerelease: true,
      description: "This release's description Test",
      commitish: "master"
    )

    version_bump_podspec(path: "TestTabBarLibrary.podspec", bump_type: "patch")

    pod_push(path: "TestTabBarLibrary.podspec")


  end
  lane :devices do
    #scan(workspace: 'TestTabBar.xcodeproj/project.xcworkspace')
    run_tests(
      scheme: "TestTabBar",
      devices: ["iPhone XR", "iPhone XS"],
      clean: true,
    )
		slack(
			message: "Test devices",
			slack_url: "https://hooks.slack.com/services/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",
			channel: "#devices"
		)
  end
end
